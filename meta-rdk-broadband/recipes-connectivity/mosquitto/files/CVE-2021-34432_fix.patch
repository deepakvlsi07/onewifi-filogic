Date: 09-June-2023
From: Kalidoss_Marimuthu@comcast.com
Source: Backport

See https://github.com/eclipse/mosquitto/commit/9b08faf0bdaf5a4f2e6e3dd1ea7e8c57f70418d6

Index: mosquitto-1.6.12/lib/util_topic.c
===================================================================
--- mosquitto-1.6.12.orig/lib/util_topic.c
+++ mosquitto-1.6.12/lib/util_topic.c
@@ -52,6 +52,11 @@ int mosquitto_pub_topic_check(const char
 #ifdef WITH_BROKER
 	int hier_count = 0;
 #endif
+
+	if(str == NULL){
+		return MOSQ_ERR_INVAL;
+	}
+
 	while(str && str[0]){
 		if(str[0] == '+' || str[0] == '#'){
 			return MOSQ_ERR_INVAL;
@@ -79,7 +84,9 @@ int mosquitto_pub_topic_check2(const cha
 	int hier_count = 0;
 #endif
 
-	if(len > 65535) return MOSQ_ERR_INVAL;
+	if(str == NULL || len > 65535){
+		return MOSQ_ERR_INVAL;
+	}
 
 	for(i=0; i<len; i++){
 		if(str[i] == '+' || str[i] == '#'){
@@ -113,7 +120,11 @@ int mosquitto_sub_topic_check(const char
 	int hier_count = 0;
 #endif
 
-	while(str && str[0]){
+	if(str == NULL){
+		return MOSQ_ERR_INVAL;
+	}
+
+	while(str[0]){
 		if(str[0] == '+'){
 			if((c != '\0' && c != '/') || (str[1] != '\0' && str[1] != '/')){
 				return MOSQ_ERR_INVAL;
@@ -148,7 +159,9 @@ int mosquitto_sub_topic_check2(const cha
 	int hier_count = 0;
 #endif
 
-	if(len > 65535) return MOSQ_ERR_INVAL;
+	if(str == NULL || len > 65535){
+		return MOSQ_ERR_INVAL;
+	}
 
 	for(i=0; i<len; i++){
 		if(str[i] == '+'){
