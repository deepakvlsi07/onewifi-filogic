From 6fabe2f77c0d07f772facd3a7ce1d806c51ad828 Mon Sep 17 00:00:00 2001
From: Alluri Revathi Bhavani <RevathiBhavani_Alluri@comcast.com>
Date: Mon, 8 May 2023 10:23:13 +0000
Subject: [PATCH] Date: JAN 20, 2010 From:
 3db5806d012082b9e25cc36d09f19cd736a468f Subject: [PATCH] CVE-2010-0001
 Source:
 http://git.savannah.gnu.org/cgit/gzip.git/commit/?id=a3db5806d012082b9e25cc36d09f19cd736a468f
 License: GPLV2 Upstream-Status:
 http://git.savannah.gnu.org/cgit/gzip.git/commit/?id=a3db5806d012082b9e25cc36d09f19cd736a468f
 Signed-off-by: Jim Meyering / aallur481(RevathiBhavani_Alluri@comcast.com)

---
 NEWS    | 5 +++++
 THANKS  | 1 +
 unlzw.c | 3 ++-
 3 files changed, 8 insertions(+), 1 deletion(-)

diff --git a/NEWS b/NEWS
index b809273..e03bcb3 100644
--- a/NEWS
+++ b/NEWS
@@ -1,3 +1,8 @@
+  gzip -d could segfault and/or clobber the stack, possibly leading to
+  arbitrary code execution.  This affects x86_64 but not 32-bit systems.
+  This fixes CVE-2010-0001.
+  For more details, see http://bugzilla.redhat.com/554418
+
 Major changes in Gzip 1.3.12 (2007-04-13)
 
 * znew now uses $TMPDIR (default /tmp) instead of always using /tmp.
diff --git a/THANKS b/THANKS
index c7fd00b..f9e329a 100644
--- a/THANKS
+++ b/THANKS
@@ -97,6 +97,7 @@ Harald Hanche-Olsen     hanche@ams.sunysb.edu
 Darrel R. Hankerson     hankedr@mail.auburn.edu
 Mark Hanning-Lee        markhl@romeo.caltech.edu
 Lars Hecking            st000002@hrz1.hrz.th-darmstadt.de
+Aki Helin               aki.helin@iki.fi
 Ruediger Helsch         ruediger@ramz.ing.tu-bs.de
 Mark C. Henderson       mch@sqwest.wimsey.bc.ca
 Karl Heuer              karl@kelp.boston.ma.us
diff --git a/unlzw.c b/unlzw.c
index a330f98..a10b424 100644
--- a/unlzw.c
+++ b/unlzw.c
@@ -248,7 +248,8 @@ int unlzw(in, out)
 	int  o;

     resetbuf:
-	e = insize-(o = (posbits>>3));
+    o = posbits >> 3;
+	e = o <= insize ? insize - o : 0;

 	for (i = 0 ; i < e ; ++i) {
 	    inbuf[i] = inbuf[i+o];
