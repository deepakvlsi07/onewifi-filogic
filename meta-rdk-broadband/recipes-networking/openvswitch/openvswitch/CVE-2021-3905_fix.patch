From 167ad8276f44cc4b60857924f0b85d500eee02c7 Mon Sep 17 00:00:00 2001
From: Alluri Revathi Bhavani <RevathiBhavani_Alluri@comcast.com>
Date: Sat, 6 May 2023 10:37:21 +0000
Subject: [PATCH] Date: Oct 12, 2021 From:
 803ed12e31b0377c37d7aa8c94b3b92f2081e349 Subject: [PATCH] CVE-2021-3905
 Source:
 https://github.com/openvswitch/ovs/commit/803ed12e31b0377c37d7aa8c94b3b92f2081e349
 License: GPLV2 Upstream-Status:
 https://github.com/openvswitch/ovs/commit/803ed12e31b0377c37d7aa8c94b3b92f2081e349
 Signed-off-by: aserdean / aallur481(RevathiBhavani_Alluri@comcast.com)

---
 lib/ipf.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/lib/ipf.c b/lib/ipf.c
index 446e89d13..66203f642 100644
--- a/lib/ipf.c
+++ b/lib/ipf.c
@@ -945,6 +945,8 @@ ipf_extract_frags_from_batch(struct ipf *ipf, struct dp_packet_batch *pb,
             if (!ipf_handle_frag(ipf, pkt, dl_type, zone, now, hash_basis,
                                  pb->do_not_steal)) {
                 dp_packet_batch_refill(pb, pkt, pb_idx);
+            } else {
+                dp_packet_delete(pkt);
             }
             ovs_mutex_unlock(&ipf->ipf_lock);
         } else {
