Date: Nov 02, 2023
From: 9d917aad37778a9f4a96ba358415f077f3f36f3b
Subject: Patch libbsd to address CVE-2019-20367
Source:  Github  https://gitlab.freedesktop.org/libbsd/libbsd/-/commit/9d917aad37778a9f4a96ba358415f077f3f36f3b
License:
Upstream-Status: Pending
Signed-off-by: kmarim851 <Kalidoss_Marimuthu@comcast.com>
---
Index: libbsd-0.8.2/src/nlist.c
===================================================================
--- libbsd-0.8.2.orig/src/nlist.c
+++ libbsd-0.8.2/src/nlist.c
@@ -227,16 +227,18 @@ __fdnlist(int fd, struct nlist *list)
 		symsize -= cc;
 		for (s = sbuf; cc > 0 && nent > 0; ++s, cc -= sizeof(*s)) {
 			char *name;
+                        Elf_Word size;
 			struct nlist *p;
 
 			name = strtab + s->st_name;
 			if (name[0] == '\0')
 				continue;
+                        size = symstrsize - s->st_name;
 
 			for (p = list; !ISLAST(p); p++) {
 				if ((p->n_un.n_name[0] == '_' &&
-				    strcmp(name, p->n_un.n_name+1) == 0)
-				    || strcmp(name, p->n_un.n_name) == 0) {
+                                    strncmp(name, p->n_un.n_name+1, size) == 0) ||
+                                    strncmp(name, p->n_un.n_name, size) == 0) {
 					elf_sym_to_nlist(p, s, shdr,
 					    ehdr.e_shnum);
 					if (--nent <= 0)
