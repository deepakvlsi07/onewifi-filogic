Date: Jun 8, 2020
From: ae9af802b5e7169c55cc5ef04dcfbded351c743d
Subject: Patch bind to address CVE-2020-8622
Source: GITHUB https://github.com/isc-projects/bind9/commit/ae9af802b5e7169c55cc5ef04dcfbded351c743d#
License: GPLV2
Upstream-Status: Pending
Signed-off-by: sroy040 <surajeet_roy@comcast.com>
---
Index: bind-9.11.19/lib/dns/openssleddsa_link.c
===================================================================
--- bind-9.11.19.orig/lib/dns/openssleddsa_link.c
+++ bind-9.11.19/lib/dns/openssleddsa_link.c
@@ -324,8 +324,12 @@ openssleddsa_verify(dst_context_t *dctx,
 	else
 		siglen = DNS_SIG_ED448SIZE;
 
+	if (siglen == 0) {
+                DST_RET(ISC_R_NOTIMPLEMENTED);
+        }
+
 	if (sig->length != siglen)
-		return (DST_R_VERIFYFAILURE);
+		DST_RET(DST_R_VERIFYFAILURE);
 
 	isc_buffer_usedregion(buf, &tbsreg);
 
